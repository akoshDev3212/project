{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
  body {
    background: #f7f8fa;
    font-family: 'Poppins', sans-serif;
  }

  .cart-container {
    max-width: 1200px;
    margin: 40px auto;
  }

  .cart-header {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    padding: 25px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .cart-header .btn {
    border-radius: 8px;
    font-weight: 600;
    padding: 10px 18px;
  }

  .cart-summary {
    display: flex;
    justify-content: center;
    gap: 40px;
    font-size: 18px;
    font-weight: 500;
    margin-top: 15px;
  }

  .cart-table {
    margin-top: 30px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    overflow: hidden;
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  thead {
    background-color: #f0f0f0;
  }

  th {
    padding: 14px 10px;
    text-transform: uppercase;
    font-size: 14px;
    font-weight: 600;
  }

  td {
    padding: 18px 10px;
    vertical-align: middle;
  }

  td img {
    border-radius: 10px;
    object-fit: cover;
  }

  tr {
    border-bottom: 1px solid #e8e8e8;
  }

  .trash-icon {
    font-size: 22px;
    color: #e74c3c;
    transition: 0.2s;
  }

  .trash-icon:hover {
    color: #c0392b;
  }

  .total-row td {
    font-weight: 700;
  }

  @media(max-width: 768px) {
    th, td {
      font-size: 14px;
    }
    .cart-header {
      flex-direction: column;
      gap: 10px;
    }
  }
</style>

<div class="cart-container">

  <!-- Header -->
  <div class="cart-header">
    <a class="btn btn-outline-danger" href="{% url 'store:store' %}">
      ‚Üê Back to main page
    </a>
    <div class="cart-summary">
      <div>Items: {{ total_quantity }}</div>
      <div>Total: <strong>{{ total_price }}</strong> sum</div>
    </div>
    <button class="btn btn-info text-white">Checkout</button>
  </div>

  <!-- Table -->
  <div class="cart-table mt-4">
    <table class="table align-middle text-center">
      <thead>
        <tr>
          <th></th>
          <th>Item</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart_items %}
        <tr>
          <td>
            <img src="{{ item.product.image.url }}" alt="{{ item.product.title }}" width="90" height="90">
          </td>
          <td>{{ item.product.title }}</td>
          <td>{{ item.product.price }} sum</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.total_price }} sum</td>
          <td>

            <div class="quantity ml-3">
              <a href="{% url 'store:edit_cart_item' item.id %}?action=add">
                  <img src="{% static '/img/up-arrow.png' %}" class="arrows" width="20px" height="20px" alt="">
              </a>

              <a href="{% url 'store:edit_cart_item' item.id %}?action=take">
                  <img src="{% static '/img/down-arrow.png' %}" width="20px" height="20px" class="arrows" alt="">
              </a>
            </div>

            <!-- DELETE BUTTON yangi URLga moslashtirilgan -->
            <a href="{% url 'store:delete_cart_item' item.id %}" class="trash-icon" title="Remove item">
              <ion-icon name="trash-outline"></ion-icon>
            </a>

          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center text-muted py-5">
            Your cart is empty üõí
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Ionicons -->
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

{% endblock %}
